<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>La Terrasse de Montr√©sor Gate Access</title>
    <link rel="manifest" href="/manifest.json" />
    <!-- //Debut icones iOS pour PWA// -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="La Terrasse" />
    <!-- //fin icones iOS // -->
    <link rel="stylesheet" href="style.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè†</text></svg>"
    />
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js" defer></script>
    <script
      src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"
      defer
    ></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js" defer></script>
    <script src="script.js" defer></script>
  </head>
  <body>
    <main class="container">
      <section id="guest-app">
        <header class="guest-header">
          <div class="logo-circle-wrapper" title="v1.1 ¬©kunu2025">
            <div class="guest-logo" id="guestLogo">üè†</div>
          </div>
          <h1 class="guest-title">
            Bienvenue
            <br />
            √† la Terrasse de Montr√©sor
          </h1>
        </header>
        <div class="guest-message" id="guestMessage">Saisissez votre code d'acc√®s</div>
        <div class="guest-content-area">
          <div id="guestPinEntry" class="guest-state-section">
            <label for="guestPinInput" class="visually-hidden">Code PIN √† 4 caract√®res</label>
            <input
              type="text"
              id="guestPinInput"
              maxlength="4"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              autocomplete="off"
              autocorrect="off"
              spellcheck="false"
              inputmode="text"
            />
            <div class="guest-input-action-buttons">
              <button
                id="guestBackspaceButton"
                class="backspace-btn"
                aria-label="Effacer le dernier caract√®re"
              >
                &#9003;
              </button>
              <button id="guestCheckPinButton" class="check-pin-btn" aria-label="Valider le PIN">
                ‚úì
              </button>
            </div>
          </div>
          <div id="dynamicGuestContent" class="guest-state-section app-hidden">
            <!-- Xtof debut modif -->
            <div
              id="guestDateOut"
              class="guest-dateout"
              style="text-align: center; font-weight: bold; margin-bottom: 8px; color: #444"
            ></div>
            <!-- Xtof fin modif -->
            <button id="portalBtn" class="portal-btn">
              Ouvrir / Fermer
              <br />
              le Portail
            </button>
            <button id="resetButton" class="reset-btn" aria-label="R√©initialiser">&#x21BB;</button>
          </div>
          <div
            id="guestLoginContainer"
            class="guest-state-section app-hidden"
            style="margin-top: 20px"
          >
            <button id="google-sign-in-btn" class="action-button primary-button">
              Se connecter avec Google
            </button>
          </div>
        </div>
      </section>

      <section id="manager-app" class="app-hidden">
        <header class="header">
          <h1 id="header-title">PIN Code Manager - Montr√©sor</h1>
          <button
            class="return-to-guest-btn"
            id="returnToGuestButton"
            title="D√©connexion"
            aria-label="D√©connexion"
          >
            <img
              id="user-avatar"
              class="user-avatar-in-btn"
              src=""
              alt="User Avatar"
              style="display: none"
            />
          </button>
        </header>
        <div class="message success" style="display: none" id="message-success"></div>
        <div class="message danger" style="display: none" id="message-danger"></div>
        <div class="message primary" style="display: none" id="message-primary"></div>
        <form class="form-container" id="pinForm">
          <div class="form-row date-row">
            <div class="form-group pin-group">
              <label for="form-pin-code" class="visually-hidden">Code PIN</label>
              <input
                type="text"
                class="form-input pin-input"
                id="form-pin-code"
                maxlength="4"
                autocomplete="off"
                placeholder="PIN"
              />
            </div>
            <div class="date-groups">
              <div class="date-group">
                <label for="form-date-in" class="pin-date-label in">IN</label>
                <input type="datetime-local" class="form-input date-input" id="form-date-in" />
              </div>
              <div class="date-group">
                <label for="form-date-out" class="pin-date-label out">OUT</label>
                <input type="datetime-local" class="form-input date-input" id="form-date-out" />
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="form-contact" class="visually-hidden">Nom du contact</label>
              <input type="text" class="form-input" id="form-contact" placeholder="Nom et Pr√©nom" />
            </div>
            <div class="form-group">
              <label for="form-phone" class="visually-hidden">T√©l√©phone</label>
              <input
                type="text"
                class="form-input"
                id="form-phone"
                placeholder="Tel, email, etc."
                inputmode="text"
              />
            </div>
          </div>
          <div class="form-actions">
            <div class="form-actions-left-group">
              <button
                type="submit"
                class="btn btn-success"
                id="submitForm"
                aria-label="Sauvegarder"
              >
                ‚úì
              </button>
              <button type="button" class="btn btn-danger" id="cancelForm" aria-label="Annuler">
                √ó
              </button>
            </div>
            <div class="form-actions-center-group">
              <button
                type="button"
                class="btn"
                id="generatePinButton"
                aria-label="G√©n√©rer un PIN al√©atoire"
              >
                ‚ú®
              </button>
              <div class="sort-control">
                <button type="button" class="btn" id="sortButton" aria-label="Trier la liste">
                  ‚áÖ
                </button>
                <div class="dropdown-menu" id="sortMenu">
                  <button type="button" class="dropdown-item" data-sort-by="contact">
                    Par Contact
                  </button>
                  <button type="button" class="dropdown-item" data-sort-by="pinCode">
                    Par PIN code
                  </button>
                  <button type="button" class="dropdown-item" data-sort-by="dateIn">
                    Par Date d'arriv√©e
                  </button>
                  <button type="button" class="dropdown-item" data-sort-by="dateOut">
                    Par Date de d√©part
                  </button>
                  <button type="button" class="dropdown-item" data-sort-by="status">
                    Par statut du PIN
                  </button>
                </div>
              </div>
            </div>
            <div class="permanent-search-wrapper" id="permanentSearchWrapper">
              <label for="permanentSearchQuery" class="visually-hidden">
                Rechercher dans les PINs
              </label>
              <input
                type="text"
                class="form-input permanent-search-input"
                id="permanentSearchQuery"
                placeholder="Rechercher..."
              />
              <span id="results-count" class="search-results-count"></span>
              <button
                type="button"
                class="clear-search-btn"
                id="clearSearchButton"
                aria-label="Effacer la recherche"
              >
                √ó
              </button>
            </div>
          </div>
        </form>
        <div class="pins-list" id="pinsList"></div>
      </section>
    </main>
  </body>
</html>
