<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>La Terrasse de Montrésor Gate Access</title>
    <meta name="description" content="Système de gestion d'accès pour La Terrasse de Montrésor" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <link rel="icon" href="/icons/favicon.ico" />
    <link rel="stylesheet" href="style.css" />
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js" defer></script>
    <script
      src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"
      defer
    ></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js" defer></script>
    <script src="script.js" defer></script>
  </head>
  <body>
    <div id="app-wrapper">
      <main class="container">
        <section id="guest-screen" class="guest-screen">
          <header class="guest-header">
            <div class="logo-circle-wrapper">
              <img src="./icons/android-chrome-192x192.png" alt="Logo" class="guest-logo" />
            </div>
            <h1 class="guest-title">Accès Portails de La Terrasse de Montrésor</h1>
          </header>
          <p id="guest-message" class="guest-message"></p>
          <div class="guest-content-area">
            <div id="guest-pin-state" class="guest-state-section">
              <label for="guestPinInput" class="visually-hidden">Entrez le code PIN</label>
              <input
                type="text"
                id="guestPinInput"
                maxlength="4"
                inputmode="numeric"
                pattern="[0-9]*"
                placeholder="0000"
              />
              <div class="guest-input-action-buttons">
                <button type="button" class="action-btn action-btn--danger" id="guestClearButton">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path
                      d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    ></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                </button>
                <button
                  type="button"
                  class="action-btn action-btn--success"
                  id="guestSubmitButton"
                  disabled
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                </button>
              </div>
            </div>

            <div id="guest-portal-state" class="guest-state-section app-hidden">
              <button type="button" id="portalBtn">Ouvrir le portail</button>
              <button type="button" class="action-btn action-btn--primary" id="returnToGuestInput">
                Retour
              </button>
            </div>
          </div>
        </section>

        <section id="manager-screen" class="manager-screen app-hidden">
          <header class="header">
            <h1 id="screen-title">Gestion des PINs</h1>
            <button class="return-to-guest-btn" id="returnToGuestScreenButton">
              <img
                src="./icons/android-chrome-192x192.png"
                alt="Retour à l'accueil"
                class="user-avatar-in-btn"
              />
            </button>
          </header>
          <p id="manager-message" class="message"></p>
          <form id="pin-form" class="form-container">
            <div class="form-row">
              <div class="form-group">
                <label for="form-contact" class="visually-hidden">Nom du contact</label>
                <input
                  type="text"
                  id="form-contact"
                  class="form-input"
                  placeholder="Nom du contact"
                  required
                />
              </div>
              <div class="form-group">
                <label for="form-phone" class="visually-hidden">Téléphone du contact</label>
                <input
                  type="text"
                  id="form-phone"
                  class="form-input"
                  placeholder="Téléphone"
                  inputmode="tel"
                />
              </div>
            </div>
            <div class="form-row date-row">
              <div class="date-groups">
                <div class="date-group">
                  <label for="form-date-in" class="pin-date-label in">Date d'arrivée:</label>
                  <input type="date" id="form-date-in" class="form-input" required />
                </div>
                <div class="date-group">
                  <label for="form-date-out" class="pin-date-label out">Date de départ:</label>
                  <input type="date" id="form-date-out" class="form-input" required />
                </div>
              </div>
              <div class="form-group pin-group">
                <label for="form-pin-code" class="visually-hidden">Code PIN</label>
                <input
                  type="text"
                  id="form-pin-code"
                  class="form-input pin-input"
                  maxlength="4"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  placeholder="0000"
                  required
                />
              </div>
            </div>
            <div class="form-actions">
              <div class="form-actions-left-group">
                <button type="submit" class="btn btn-success" id="save-pin-button">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                </button>
                <button type="button" class="btn btn-danger" id="delete-pin-button" disabled>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path
                      d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    ></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                </button>
                <button type="button" class="btn" id="clear-form-button">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                  </svg>
                </button>
              </div>
              <div class="form-actions-center-group">
                <div class="sort-control">
                  <button type="button" class="btn" id="sortButton">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path d="M3 9l9-9 9 9M12 15v-15"></path>
                    </svg>
                  </button>
                  <div class="dropdown-menu" id="sortDropdown" role="menu">
                    <button
                      type="button"
                      class="dropdown-item active"
                      data-sort-by="contact"
                      role="menuitem"
                    >
                      Par Contact
                    </button>
                    <button
                      type="button"
                      class="dropdown-item"
                      data-sort-by="dateIn"
                      role="menuitem"
                    >
                      Par Date d'arrivée
                    </button>
                    <button
                      type="button"
                      class="dropdown-item"
                      data-sort-by="dateOut"
                      role="menuitem"
                    >
                      Par Date de départ
                    </button>
                    <button
                      type="button"
                      class="dropdown-item"
                      data-sort-by="status"
                      role="menuitem"
                    >
                      Par statut du PIN
                    </button>
                  </div>
                </div>
                <div class="generate-control">
                  <button type="button" class="btn" id="generatePinButton">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="permanent-search-wrapper" id="permanentSearchWrapper">
                <label for="permanentSearchQuery" class="visually-hidden">
                  Rechercher dans les PINs
                </label>
                <input
                  type="text"
                  class="form-input permanent-search-input"
                  id="permanentSearchQuery"
                  placeholder="Rechercher..."
                  aria-describedby="results-count"
                />
                <span id="results-count" class="search-results-count" aria-live="polite">0</span>
                <button
                  type="button"
                  class="clear-search-btn"
                  id="clearSearchButton"
                  aria-label="Effacer la recherche"
                  disabled
                >
                  ×
                </button>
              </div>
            </div>
          </form>
          <div class="pins-list" id="pinsList" aria-live="polite"></div>
        </section>
      </main>
    </div>
  </body>
</html>
